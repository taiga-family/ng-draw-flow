<svg class="connection" [class.optimize-speed]="optimization$ | async">
    <!-- Marker start-->
    <defs>
        <marker
            id="df-arrowhead-arrowClosed"
            [attr.viewBox]="arrowViewBox"
            refX="0"
            refY="0"
            [attr.markerWidth]="arrowMarkerWidth"
            [attr.markerHeight]="arrowMarkerHeight"
            orient="auto-start-reverse"
            markerUnits="strokeWidth"
        >
            <polyline
                [attr.points]="arrowClosedPoints"
                stroke-linecap="round"
                stroke-linejoin="round"
                fill="context-stroke"
                stroke="context-stroke"
            />
        </marker>
        <marker
            id="df-arrowhead-arrow"
            [attr.viewBox]="arrowViewBox"
            refX="0"
            refY="0"
            [attr.markerWidth]="arrowMarkerWidth"
            [attr.markerHeight]="arrowMarkerHeight"
            orient="auto-start-reverse"
            markerUnits="strokeWidth"
        >
            <polyline
                [attr.points]="arrowPoints"
                stroke-linecap="round"
                stroke-linejoin="round"
                fill="none"
                stroke="context-stroke"
            />
        </marker>
    </defs>
    <!-- Marker end-->

    <!-- Connection line start-->
    <path class="selectable-area" [attr.d]="path$ | async" (dfSelectableElement)="onSelectedChanged($event)" />
    <path class="main-path" [attr.d]="path$ | async" [class.df-selected]="selected" [attr.marker-end]="markerEnd" />
    <!-- Connection line start-->

    <!-- Label start -->
    <foreignObject *ngIf="connection.label" class="label-container" width="100%" height="100%">
        <div
            xmlns="http://www.w3.org/1999/xhtml"
            class="label"
            [style.left.px]="(labelPosition$ | async)?.x"
            [style.top.px]="(labelPosition$ | async)?.y"
        >
            <ng-container *polymorpheusOutlet="connection.label.content as label; context: connection.label.context">
                {{ label }}
            </ng-container>
        </div>
    </foreignObject>
    <!-- Label end -->
</svg>
